<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yedam.app.book.mapper.BookMapper">
	
	<select id="selectBookAll">
		SELECT book_no, book_name, book_coverimg, book_date, book_price, book_publisher, book_info
		FROM book_tbl_06
	</select>
	<select id="getBook">
		SELECT NVL(MAX(book_no), 0) + 1 as bookNo
		FROM book_tbl_06
	</select>
	<insert id="insertBookInfo" parameterType="BookVO">
		INSERT INTO book_tbl_06(book_no
		                        ,book_name
		                        ,book_coverimg
		                        ,book_date
		                        ,book_price
		                        ,book_publisher
		                        ,book_info)
		VALUES(
			#{bookNo}
			,#{bookName}
			,#{bookCoverimg}
			,#{bookDate}
			,#{bookPrice}
			,#{bookPublisher}
			,#{bookInfo}
		)                        
	</insert>
	<select id="selectRentAll" resultType="RentVO">
		SELECT book_no, book_name, (select sum(rent_price) 
		                            from rent_tbl_06
		                            where book_no = book_tbl_06.book_no) as rent_price,
		                           (select count(book_no)
		                            from rent_tbl_06
		                            where book_no = book_tbl_06.book_no) as rent_cnt
		FROM book_tbl_06
		WHERE book_no in (SELECT book_no
                  		  FROM rent_tbl_06) 
	</select>
</mapper>